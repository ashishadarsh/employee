<div *ngIf="!loading && task" class="task-card-modern">
  <!-- Header -->
  <div class="task-header-modern">
    <h2>{{ task.title }}</h2>
    <!-- <div class="task-badges">
      <p-tag [value]="task.type" [severity]="getSeverityType(task.type)" class="type"></p-tag>
      <p-tag [value]="task.status" [severity]="getSeverity(task.status)"></p-tag>
    </div> -->
  </div>

  <div class="task-badges">
    <p-tag [value]="task.type" [severity]="getSeverityType(task.type)" class="type"></p-tag>
    <p-tag [value]="task.status[task.status.length - 1].value" [severity]="getSeverity(task.status[task.status.length - 1].value)"></p-tag>
  </div>

  <div class="task-timeline" *ngIf="events.length > 1">
    <div class="card">
      <p-timeline [value]="events" layout="horizontal" align="top">
           <ng-template #content let-event>
              <small class="text-surface-500 dark:text-surface-400">{{ event.date | date: "shortDate" }}</small>
          </ng-template>
          <ng-template #opposite let-event>
              {{ event.status }}
          </ng-template>
      </p-timeline>
  </div>
  </div>

  <!-- Meta Info -->
  <div class="task-meta-modern">
    <div class="meta-item">
      <span class="meta-label">Assigned Date:</span>
      <span class="meta-value">{{ task.assignedDate | date: 'mediumDate' }}</span>
    </div>
    <div class="meta-item">
      <span class="meta-label">Assigned By:</span>
      <span class="meta-value">{{ empName }}</span>
    </div>
    <div class="meta-item">
      <span class="meta-label">Completion Date:</span>
      <span class="meta-value">{{ task.completionDate | date: 'mediumDate' }}</span>
    </div>
  </div>

  <!-- Scrollable Description -->
  <div class="task-body-modern scrollable">
    <h4>Description</h4>
    <div class="description-content" [innerHTML]="task.description"></div>
  </div>


  <!-- Fixed Actions -->
  <div class="task-actions-modern fixed-actions">
    <p-button
      label="Back"
      routerLink="/tasks"
      icon="pi pi-arrow-left"
      styleClass="p-button-secondary"
      [raised]="true"
    ></p-button>
    <p-button
      label="Edit"
      [routerLink]="['/tasks/edit', task._id]"
      icon="pi pi-pencil"
      variant="outlined"
      styleClass="p-button-info"
      [raised]="true"
      severity="info"
    ></p-button>
  </div>
</div>
